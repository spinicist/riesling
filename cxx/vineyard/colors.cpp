#include "colors.hpp"

namespace rl {

std::array<float, 3> const white{1.f, 1.f, 1.f};
// Thanks CMasher!
std::array<std::array<float, 3>, 511> const iceburn{std::array<float, 3>{0.57869284, 0.94700453, 0.95383509},
                                                    {0.57330096, 0.94244813, 0.95218584},
                                                    {0.56790414, 0.93790619, 0.95055025},
                                                    {0.56250183, 0.93337844, 0.94892950},
                                                    {0.55709400, 0.92886470, 0.94732325},
                                                    {0.55168026, 0.92436472, 0.94573223},
                                                    {0.54626041, 0.91987829, 0.94415663},
                                                    {0.54083428, 0.91540519, 0.94259649},
                                                    {0.53540142, 0.91094515, 0.94105277},
                                                    {0.52996183, 0.90649797, 0.93952504},
                                                    {0.52451517, 0.90206341, 0.93801392},
                                                    {0.51906115, 0.89764122, 0.93651980},
                                                    {0.51359971, 0.89323118, 0.93504255},
                                                    {0.50813051, 0.88883304, 0.93358271},
                                                    {0.50265329, 0.88444654, 0.93214066},
                                                    {0.49716797, 0.88007146, 0.93071625},
                                                    {0.49167433, 0.87570754, 0.92930975},
                                                    {0.48617195, 0.87135452, 0.92792190},
                                                    {0.48066080, 0.86701216, 0.92655247},
                                                    {0.47514069, 0.86268020, 0.92520162},
                                                    {0.46961139, 0.85835838, 0.92386959},
                                                    {0.46407266, 0.85404645, 0.92255672},
                                                    {0.45852424, 0.84974413, 0.92126329},
                                                    {0.45296603, 0.84545117, 0.91998924},
                                                    {0.44739784, 0.84116729, 0.91873474},
                                                    {0.44181946, 0.83689223, 0.91749997},
                                                    {0.43623070, 0.83262572, 0.91628509},
                                                    {0.43063137, 0.82836747, 0.91509023},
                                                    {0.42502129, 0.82411721, 0.91391555},
                                                    {0.41940026, 0.81987466, 0.91276117},
                                                    {0.41376812, 0.81563953, 0.91162721},
                                                    {0.40812469, 0.81141153, 0.91051377},
                                                    {0.40246980, 0.80719037, 0.90942095},
                                                    {0.39680330, 0.80297576, 0.90834883},
                                                    {0.39112505, 0.79876739, 0.90729746},
                                                    {0.38543488, 0.79456497, 0.90626692},
                                                    {0.37973269, 0.79036819, 0.90525724},
                                                    {0.37401834, 0.78617674, 0.90426845},
                                                    {0.36829174, 0.78199032, 0.90330056},
                                                    {0.36255279, 0.77780859, 0.90235356},
                                                    {0.35680142, 0.77363124, 0.90142744},
                                                    {0.35103745, 0.76945793, 0.90052248},
                                                    {0.34526089, 0.76528834, 0.89963852},
                                                    {0.33947179, 0.76112213, 0.89877532},
                                                    {0.33367017, 0.75695898, 0.89793279},
                                                    {0.32785588, 0.75279849, 0.89711137},
                                                    {0.32202912, 0.74864036, 0.89631060},
                                                    {0.31619008, 0.74448422, 0.89553017},
                                                    {0.31033866, 0.74032967, 0.89477063},
                                                    {0.30447528, 0.73617639, 0.89403125},
                                                    {0.29860011, 0.73202399, 0.89331209},
                                                    {0.29271343, 0.72787206, 0.89261309},
                                                    {0.28681572, 0.72372025, 0.89193378},
                                                    {0.28090735, 0.71956814, 0.89127427},
                                                    {0.27498896, 0.71541533, 0.89063408},
                                                    {0.26906124, 0.71126143, 0.89001292},
                                                    {0.26312486, 0.70710597, 0.88941086},
                                                    {0.25718092, 0.70294859, 0.88882703},
                                                    {0.25123043, 0.69878883, 0.88826140},
                                                    {0.24527462, 0.69462621, 0.88771373},
                                                    {0.23931508, 0.69046034, 0.88718322},
                                                    {0.23335351, 0.68629075, 0.88666946},
                                                    {0.22739188, 0.68211696, 0.88617198},
                                                    {0.22143248, 0.67793848, 0.88569042},
                                                    {0.21547800, 0.67375483, 0.88522406},
                                                    {0.20953152, 0.66956553, 0.88477214},
                                                    {0.20359659, 0.66537008, 0.88433394},
                                                    {0.19767730, 0.66116797, 0.88390868},
                                                    {0.19177835, 0.65695868, 0.88349548},
                                                    {0.18590517, 0.65274164, 0.88309369},
                                                    {0.18006401, 0.64851634, 0.88270206},
                                                    {0.17426203, 0.64428224, 0.88231942},
                                                    {0.16850747, 0.64003882, 0.88194450},
                                                    {0.16280986, 0.63578543, 0.88157637},
                                                    {0.15718007, 0.63152155, 0.88121346},
                                                    {0.15163047, 0.62724665, 0.88085394},
                                                    {0.14617558, 0.62296002, 0.88049685},
                                                    {0.14083138, 0.61866121, 0.88013964},
                                                    {0.13561664, 0.61434953, 0.87978090},
                                                    {0.13055227, 0.61002443, 0.87941833},
                                                    {0.12566179, 0.60568534, 0.87904945},
                                                    {0.12097171, 0.60133167, 0.87867186},
                                                    {0.11651156, 0.59696278, 0.87828307},
                                                    {0.11231340, 0.59257814, 0.87787994},
                                                    {0.10841196, 0.58817719, 0.87745920},
                                                    {0.10484430, 0.58375940, 0.87701740},
                                                    {0.10164914, 0.57932420, 0.87655087},
                                                    {0.09886510, 0.57487117, 0.87605525},
                                                    {0.09652994, 0.57039990, 0.87552588},
                                                    {0.09468006, 0.56590987, 0.87495827},
                                                    {0.09334588, 0.56140087, 0.87434666},
                                                    {0.09255347, 0.55687251, 0.87368561},
                                                    {0.09231938, 0.55232472, 0.87296842},
                                                    {0.09265244, 0.54775739, 0.87218838},
                                                    {0.09355187, 0.54317052, 0.87133816},
                                                    {0.09500670, 0.53856430, 0.87040963},
                                                    {0.09699741, 0.53393908, 0.86939415},
                                                    {0.09949602, 0.52929541, 0.86828228},
                                                    {0.10246810, 0.52463411, 0.86706387},
                                                    {0.10587541, 0.51995613, 0.86572833},
                                                    {0.10967576, 0.51526281, 0.86426419},
                                                    {0.11382580, 0.51055574, 0.86265950},
                                                    {0.11828050, 0.50583694, 0.86090155},
                                                    {0.12299581, 0.50110877, 0.85897736},
                                                    {0.12792818, 0.49637399, 0.85687361},
                                                    {0.13303495, 0.49163581, 0.85457687},
                                                    {0.13827461, 0.48689788, 0.85207389},
                                                    {0.14360717, 0.48216423, 0.84935190},
                                                    {0.14899424, 0.47743927, 0.84639902},
                                                    {0.15439799, 0.47272781, 0.84320453},
                                                    {0.15978344, 0.46803477, 0.83975943},
                                                    {0.16511635, 0.46336535, 0.83605671},
                                                    {0.17036521, 0.45872465, 0.83209177},
                                                    {0.17550082, 0.45411767, 0.82786267},
                                                    {0.18049667, 0.44954915, 0.82337025},
                                                    {0.18532943, 0.44502339, 0.81861819},
                                                    {0.18997899, 0.44054421, 0.81361291},
                                                    {0.19442908, 0.43611475, 0.80836325},
                                                    {0.19866639, 0.43173758, 0.80288030},
                                                    {0.20268189, 0.42741446, 0.79717672},
                                                    {0.20646873, 0.42314661, 0.79126674},
                                                    {0.21002416, 0.41893452, 0.78516513},
                                                    {0.21334744, 0.41477813, 0.77888727},
                                                    {0.21644007, 0.41067692, 0.77244864},
                                                    {0.21930549, 0.40662992, 0.76586449},
                                                    {0.22194871, 0.40263581, 0.75914954},
                                                    {0.22437598, 0.39869301, 0.75231781},
                                                    {0.22659392, 0.39479978, 0.74538284},
                                                    {0.22861020, 0.39095420, 0.73835702},
                                                    {0.23043243, 0.38715428, 0.73125216},
                                                    {0.23206893, 0.38339797, 0.72407881},
                                                    {0.23352752, 0.37968323, 0.71684701},
                                                    {0.23481608, 0.37600805, 0.70956590},
                                                    {0.23594240, 0.37237043, 0.70224378},
                                                    {0.23691411, 0.36876841, 0.69488810},
                                                    {0.23773864, 0.36520013, 0.68750558},
                                                    {0.23842228, 0.36166379, 0.68010314},
                                                    {0.23897259, 0.35815764, 0.67268550},
                                                    {0.23939501, 0.35468004, 0.66525875},
                                                    {0.23969623, 0.35122941, 0.65782678},
                                                    {0.23988177, 0.34780424, 0.65039394},
                                                    {0.23995694, 0.34440312, 0.64296415},
                                                    {0.23992678, 0.34102470, 0.63554088},
                                                    {0.23979609, 0.33766769, 0.62812723},
                                                    {0.23956944, 0.33433088, 0.62072594},
                                                    {0.23925118, 0.33101313, 0.61333943},
                                                    {0.23884542, 0.32771334, 0.60596984},
                                                    {0.23835581, 0.32443050, 0.59861944},
                                                    {0.23778580, 0.32116362, 0.59129023},
                                                    {0.23713919, 0.31791178, 0.58398324},
                                                    {0.23641859, 0.31467410, 0.57670083},
                                                    {0.23562751, 0.31144977, 0.56944356},
                                                    {0.23476863, 0.30823799, 0.56221282},
                                                    {0.23384436, 0.30503801, 0.55501014},
                                                    {0.23285756, 0.30184913, 0.54783592},
                                                    {0.23181055, 0.29867067, 0.54069108},
                                                    {0.23070554, 0.29550198, 0.53357645},
                                                    {0.22954464, 0.29234247, 0.52649273},
                                                    {0.22832987, 0.28919153, 0.51944051},
                                                    {0.22706312, 0.28604862, 0.51242029},
                                                    {0.22574622, 0.28291320, 0.50543250},
                                                    {0.22438088, 0.27978477, 0.49847747},
                                                    {0.22296875, 0.27666284, 0.49155548},
                                                    {0.22151140, 0.27354694, 0.48466672},
                                                    {0.22001024, 0.27043662, 0.47781146},
                                                    {0.21846644, 0.26733144, 0.47099036},
                                                    {0.21688162, 0.26423100, 0.46420287},
                                                    {0.21525699, 0.26113489, 0.45744915},
                                                    {0.21359342, 0.25804272, 0.45072991},
                                                    {0.21189245, 0.25495414, 0.44404423},
                                                    {0.21015473, 0.25186874, 0.43739306},
                                                    {0.20838166, 0.24878622, 0.43077545},
                                                    {0.20657379, 0.24570619, 0.42419227},
                                                    {0.20473243, 0.24262836, 0.41764250},
                                                    {0.20285807, 0.23955237, 0.41112692},
                                                    {0.20095176, 0.23647793, 0.40464482},
                                                    {0.19901430, 0.23340473, 0.39819596},
                                                    {0.19704615, 0.23033243, 0.39178094},
                                                    {0.19504823, 0.22726077, 0.38539893},
                                                    {0.19302121, 0.22418944, 0.37904975},
                                                    {0.19096568, 0.22111817, 0.37273324},
                                                    {0.18888207, 0.21804663, 0.36644962},
                                                    {0.18677107, 0.21497457, 0.36019827},
                                                    {0.18463321, 0.21190170, 0.35397893},
                                                    {0.18246898, 0.20882775, 0.34779136},
                                                    {0.18027883, 0.20575244, 0.34163532},
                                                    {0.17806319, 0.20267549, 0.33551054},
                                                    {0.17582247, 0.19959662, 0.32941673},
                                                    {0.17355705, 0.19651555, 0.32335359},
                                                    {0.17126727, 0.19343202, 0.31732082},
                                                    {0.16895348, 0.19034573, 0.31131809},
                                                    {0.16661598, 0.18725641, 0.30534506},
                                                    {0.16425505, 0.18416377, 0.29940139},
                                                    {0.16187095, 0.18106754, 0.29348671},
                                                    {0.15946392, 0.17796741, 0.28760066},
                                                    {0.15703418, 0.17486310, 0.28174285},
                                                    {0.15458188, 0.17175430, 0.27591300},
                                                    {0.15210713, 0.16864071, 0.27011088},
                                                    {0.14961017, 0.16552201, 0.26433584},
                                                    {0.14709112, 0.16239789, 0.25858744},
                                                    {0.14455007, 0.15926804, 0.25286525},
                                                    {0.14198701, 0.15613210, 0.24716916},
                                                    {0.13940203, 0.15298974, 0.24149861},
                                                    {0.13679522, 0.14984061, 0.23585293},
                                                    {0.13416654, 0.14668436, 0.23023175},
                                                    {0.13151588, 0.14352057, 0.22463501},
                                                    {0.12884334, 0.14034890, 0.21906169},
                                                    {0.12614878, 0.13716893, 0.21351147},
                                                    {0.12343203, 0.13398023, 0.20798415},
                                                    {0.12069311, 0.13078240, 0.20247868},
                                                    {0.11793173, 0.12757495, 0.19699505},
                                                    {0.11514778, 0.12435745, 0.19153238},
                                                    {0.11234104, 0.12112938, 0.18609015},
                                                    {0.10951121, 0.11789024, 0.18066797},
                                                    {0.10665810, 0.11463950, 0.17526489},
                                                    {0.10378128, 0.11137658, 0.16988075},
                                                    {0.10088052, 0.10810090, 0.16451437},
                                                    {0.09795529, 0.10481182, 0.15916562},
                                                    {0.09500529, 0.10150871, 0.15383328},
                                                    {0.09202991, 0.09819083, 0.14851704},
                                                    {0.08902871, 0.09485748, 0.14321584},
                                                    {0.08600106, 0.09150787, 0.13792899},
                                                    {0.08294630, 0.08814114, 0.13265572},
                                                    {0.07986379, 0.08475645, 0.12739482},
                                                    {0.07675264, 0.08135279, 0.12214593},
                                                    {0.07361211, 0.07792919, 0.11690747},
                                                    {0.07044121, 0.07448455, 0.11167864},
                                                    {0.06723890, 0.07101767, 0.10645840},
                                                    {0.06400410, 0.06752732, 0.10124526},
                                                    {0.06073553, 0.06401210, 0.09603817},
                                                    {0.05743181, 0.06047052, 0.09083573},
                                                    {0.05409148, 0.05690097, 0.08563621},
                                                    {0.05071284, 0.05330166, 0.08043811},
                                                    {0.04729398, 0.04967062, 0.07523980},
                                                    {0.04383290, 0.04600573, 0.07003905},
                                                    {0.04032533, 0.04230459, 0.06483370},
                                                    {0.03681198, 0.03855880, 0.05962158},
                                                    {0.03343838, 0.03492349, 0.05439990},
                                                    {0.03020655, 0.03145663, 0.04916556},
                                                    {0.02711859, 0.02815891, 0.04391515},
                                                    {0.02417669, 0.02503115, 0.03863829},
                                                    {0.02138315, 0.02207428, 0.03360127},
                                                    {0.01874050, 0.01928945, 0.02894484},
                                                    {0.01625140, 0.01667799, 0.02466102},
                                                    {0.01391875, 0.01424146, 0.02074208},
                                                    {0.01174570, 0.01198170, 0.01718058},
                                                    {0.00973575, 0.00990088, 0.01396944},
                                                    {0.00789285, 0.00800160, 0.01110189},
                                                    {0.00622148, 0.00628698, 0.00857157},
                                                    {0.00472684, 0.00476083, 0.00637274},
                                                    {0.00341513, 0.00342790, 0.00450037},
                                                    {0.00229394, 0.00229426, 0.00295046},
                                                    {0.00137302, 0.00136800, 0.00172056},
                                                    {0.00066576, 0.00066063, 0.00081098},
                                                    {0.00019292, 0.00019060, 0.00022793},
                                                    {0.00000000, 0.00000000, 0.00000000},
                                                    {0.00024615, 0.00017402, 0.00018678},
                                                    {0.00087651, 0.00059522, 0.00064582},
                                                    {0.00186026, 0.00121727, 0.00133402},
                                                    {0.00319002, 0.00201789, 0.00223163},
                                                    {0.00486438, 0.00298218, 0.00332572},
                                                    {0.00688465, 0.00409900, 0.00460664},
                                                    {0.00925360, 0.00535941, 0.00606670},
                                                    {0.01197496, 0.00675600, 0.00769941},
                                                    {0.01505310, 0.00828238, 0.00949915},
                                                    {0.01849283, 0.00993297, 0.01146086},
                                                    {0.02229932, 0.01170280, 0.01357993},
                                                    {0.02647801, 0.01358738, 0.01585207},
                                                    {0.03103458, 0.01558259, 0.01827322},
                                                    {0.03597484, 0.01768468, 0.02083953},
                                                    {0.04128527, 0.01989015, 0.02354726},
                                                    {0.04663688, 0.02219574, 0.02639278},
                                                    {0.05195829, 0.02459837, 0.02937254},
                                                    {0.05725332, 0.02709516, 0.03248304},
                                                    {0.06252528, 0.02968336, 0.03572079},
                                                    {0.06777709, 0.03236039, 0.03908234},
                                                    {0.07301135, 0.03512373, 0.04249786},
                                                    {0.07823033, 0.03797101, 0.04585147},
                                                    {0.08343602, 0.04089098, 0.04915452},
                                                    {0.08863026, 0.04376921, 0.05240871},
                                                    {0.09381466, 0.04660434, 0.05561550},
                                                    {0.09899070, 0.04939825, 0.05877621},
                                                    {0.10415972, 0.05215268, 0.06189196},
                                                    {0.10932303, 0.05486915, 0.06496371},
                                                    {0.11448168, 0.05754915, 0.06799237},
                                                    {0.11963664, 0.06019409, 0.07097870},
                                                    {0.12478882, 0.06280523, 0.07392337},
                                                    {0.12993921, 0.06538365, 0.07682690},
                                                    {0.13508850, 0.06793051, 0.07968980},
                                                    {0.14023734, 0.07044690, 0.08251252},
                                                    {0.14538653, 0.07293368, 0.08529534},
                                                    {0.15053661, 0.07539182, 0.08803858},
                                                    {0.15568804, 0.07782225, 0.09074250},
                                                    {0.16084158, 0.08022562, 0.09340714},
                                                    {0.16599741, 0.08260293, 0.09603279},
                                                    {0.17115623, 0.08495474, 0.09861938},
                                                    {0.17631820, 0.08728194, 0.10116707},
                                                    {0.18148390, 0.08958506, 0.10367575},
                                                    {0.18665343, 0.09186493, 0.10614548},
                                                    {0.19182735, 0.09412200, 0.10857605},
                                                    {0.19700567, 0.09635711, 0.11096751},
                                                    {0.20218885, 0.09857069, 0.11331960},
                                                    {0.20737699, 0.10076343, 0.11563220},
                                                    {0.21257022, 0.10293594, 0.11790518},
                                                    {0.21776892, 0.10508866, 0.12013818},
                                                    {0.22297307, 0.10722225, 0.12233107},
                                                    {0.22818278, 0.10933729, 0.12448359},
                                                    {0.23339817, 0.11143429, 0.12659544},
                                                    {0.23861945, 0.11351372, 0.12866624},
                                                    {0.24384653, 0.11557623, 0.13069576},
                                                    {0.24907946, 0.11762233, 0.13268366},
                                                    {0.25431826, 0.11965258, 0.13462958},
                                                    {0.25956293, 0.12166750, 0.13653315},
                                                    {0.26481344, 0.12366766, 0.13839399},
                                                    {0.27006976, 0.12565358, 0.14021170},
                                                    {0.27533180, 0.12762583, 0.14198589},
                                                    {0.28059949, 0.12958498, 0.14371614},
                                                    {0.28587272, 0.13153160, 0.14540202},
                                                    {0.29115134, 0.13346626, 0.14704313},
                                                    {0.29643521, 0.13538958, 0.14863902},
                                                    {0.30172414, 0.13730214, 0.15018927},
                                                    {0.30701794, 0.13920457, 0.15169344},
                                                    {0.31231639, 0.14109751, 0.15315110},
                                                    {0.31761928, 0.14298158, 0.15456179},
                                                    {0.32292642, 0.14485737, 0.15592496},
                                                    {0.32823742, 0.14672565, 0.15724032},
                                                    {0.33355199, 0.14858712, 0.15850743},
                                                    {0.33886990, 0.15044238, 0.15972574},
                                                    {0.34419076, 0.15229223, 0.16089488},
                                                    {0.34951411, 0.15413745, 0.16201454},
                                                    {0.35483980, 0.15597865, 0.16308405},
                                                    {0.36016717, 0.15781679, 0.16410329},
                                                    {0.36549598, 0.15965253, 0.16507166},
                                                    {0.37082563, 0.16148682, 0.16598898},
                                                    {0.37615579, 0.16332036, 0.16685469},
                                                    {0.38148580, 0.16515417, 0.16766869},
                                                    {0.38681532, 0.16698898, 0.16843040},
                                                    {0.39214367, 0.16882582, 0.16913973},
                                                    {0.39747030, 0.17066560, 0.16979641},
                                                    {0.40279473, 0.17250917, 0.17040000},
                                                    {0.40811625, 0.17435762, 0.17095048},
                                                    {0.41343422, 0.17621191, 0.17144765},
                                                    {0.41874803, 0.17807305, 0.17189132},
                                                    {0.42405705, 0.17994202, 0.17228129},
                                                    {0.42936053, 0.18181993, 0.17261758},
                                                    {0.43465775, 0.18370783, 0.17290016},
                                                    {0.43994800, 0.18560681, 0.17312900},
                                                    {0.44523052, 0.18751796, 0.17330414},
                                                    {0.45050455, 0.18944239, 0.17342567},
                                                    {0.45576931, 0.19138122, 0.17349371},
                                                    {0.46102401, 0.19333559, 0.17350844},
                                                    {0.46626782, 0.19530663, 0.17347009},
                                                    {0.47149993, 0.19729549, 0.17337894},
                                                    {0.47671950, 0.19930331, 0.17323530},
                                                    {0.48192569, 0.20133125, 0.17303958},
                                                    {0.48711764, 0.20338044, 0.17279218},
                                                    {0.49229449, 0.20545203, 0.17249361},
                                                    {0.49745539, 0.20754714, 0.17214440},
                                                    {0.50259949, 0.20966688, 0.17174506},
                                                    {0.50772591, 0.21181236, 0.17129632},
                                                    {0.51283378, 0.21398469, 0.17079886},
                                                    {0.51792224, 0.21618491, 0.17025344},
                                                    {0.52299045, 0.21841406, 0.16966083},
                                                    {0.52803758, 0.22067316, 0.16902184},
                                                    {0.53306277, 0.22296319, 0.16833743},
                                                    {0.53806522, 0.22528511, 0.16760853},
                                                    {0.54304412, 0.22763981, 0.16683608},
                                                    {0.54799868, 0.23002817, 0.16602113},
                                                    {0.55292813, 0.23245103, 0.16516477},
                                                    {0.55783173, 0.23490917, 0.16426807},
                                                    {0.56270875, 0.23740332, 0.16333217},
                                                    {0.56755850, 0.23993418, 0.16235825},
                                                    {0.57238029, 0.24250238, 0.16134750},
                                                    {0.57717348, 0.24510851, 0.16030114},
                                                    {0.58193746, 0.24775310, 0.15922042},
                                                    {0.58667165, 0.25043664, 0.15810659},
                                                    {0.59137548, 0.25315955, 0.15696096},
                                                    {0.59604843, 0.25592219, 0.15578480},
                                                    {0.60069003, 0.25872487, 0.15457938},
                                                    {0.60529979, 0.26156787, 0.15334610},
                                                    {0.60987733, 0.26445137, 0.15208620},
                                                    {0.61442224, 0.26737554, 0.15080101},
                                                    {0.61893416, 0.27034047, 0.14949185},
                                                    {0.62341279, 0.27334621, 0.14816010},
                                                    {0.62785784, 0.27639275, 0.14680699},
                                                    {0.63226905, 0.27948004, 0.14543385},
                                                    {0.63664621, 0.28260800, 0.14404197},
                                                    {0.64098913, 0.28577648, 0.14263274},
                                                    {0.64529766, 0.28898529, 0.14120738},
                                                    {0.64957166, 0.29223423, 0.13976716},
                                                    {0.65381105, 0.29552304, 0.13831336},
                                                    {0.65801576, 0.29885142, 0.13684725},
                                                    {0.66218574, 0.30221905, 0.13537010},
                                                    {0.66632098, 0.30562559, 0.13388318},
                                                    {0.67042148, 0.30907066, 0.13238773},
                                                    {0.67448729, 0.31255384, 0.13088503},
                                                    {0.67851846, 0.31607473, 0.12937632},
                                                    {0.68251505, 0.31963288, 0.12786285},
                                                    {0.68647718, 0.32322782, 0.12634591},
                                                    {0.69040493, 0.32685910, 0.12482673},
                                                    {0.69429846, 0.33052621, 0.12330661},
                                                    {0.69815790, 0.33422868, 0.12178683},
                                                    {0.70198340, 0.33796599, 0.12026868},
                                                    {0.70577514, 0.34173764, 0.11875347},
                                                    {0.70953331, 0.34554309, 0.11724277},
                                                    {0.71325810, 0.34938183, 0.11573784},
                                                    {0.71694971, 0.35325337, 0.11423999},
                                                    {0.72060834, 0.35715718, 0.11275072},
                                                    {0.72423425, 0.36109269, 0.11127184},
                                                    {0.72782762, 0.36505946, 0.10980449},
                                                    {0.73138870, 0.36905693, 0.10835048},
                                                    {0.73491775, 0.37308460, 0.10691154},
                                                    {0.73841496, 0.37714200, 0.10548912},
                                                    {0.74188065, 0.38122856, 0.10408544},
                                                    {0.74531498, 0.38534389, 0.10270186},
                                                    {0.74871828, 0.38948741, 0.10134077},
                                                    {0.75209074, 0.39365872, 0.10000384},
                                                    {0.75543264, 0.39785734, 0.09869323},
                                                    {0.75874426, 0.40208277, 0.09741133},
                                                    {0.76202578, 0.40633464, 0.09615999},
                                                    {0.76527751, 0.41061247, 0.09494179},
                                                    {0.76849973, 0.41491579, 0.09375926},
                                                    {0.77169263, 0.41924427, 0.09261462},
                                                    {0.77485646, 0.42359748, 0.09151047},
                                                    {0.77799148, 0.42797503, 0.09044948},
                                                    {0.78109800, 0.43237646, 0.08943468},
                                                    {0.78417621, 0.43680146, 0.08846857},
                                                    {0.78722634, 0.44124968, 0.08755401},
                                                    {0.79024865, 0.44572074, 0.08669390},
                                                    {0.79324337, 0.45021432, 0.08589118},
                                                    {0.79621073, 0.45473007, 0.08514882},
                                                    {0.79915097, 0.45926767, 0.08446980},
                                                    {0.80206433, 0.46382681, 0.08385706},
                                                    {0.80495101, 0.46840720, 0.08331354},
                                                    {0.80781125, 0.47300854, 0.08284214},
                                                    {0.81064525, 0.47763056, 0.08244567},
                                                    {0.81345329, 0.48227294, 0.08212705},
                                                    {0.81623558, 0.48693542, 0.08188894},
                                                    {0.81899227, 0.49161779, 0.08173368},
                                                    {0.82172356, 0.49631982, 0.08166363},
                                                    {0.82442963, 0.50104128, 0.08168096},
                                                    {0.82711088, 0.50578179, 0.08178822},
                                                    {0.82976733, 0.51054129, 0.08198674},
                                                    {0.83239912, 0.51531958, 0.08227805},
                                                    {0.83500666, 0.52011631, 0.08266403},
                                                    {0.83758998, 0.52493140, 0.08314546},
                                                    {0.84014922, 0.52976470, 0.08372309},
                                                    {0.84268481, 0.53461583, 0.08439814},
                                                    {0.84519660, 0.53948489, 0.08517024},
                                                    {0.84768513, 0.54437144, 0.08604030},
                                                    {0.85015020, 0.54927557, 0.08700745},
                                                    {0.85259236, 0.55419689, 0.08807206},
                                                    {0.85501137, 0.55913552, 0.08923280},
                                                    {0.85740788, 0.56409100, 0.09048973},
                                                    {0.85978161, 0.56906349, 0.09184109},
                                                    {0.86213299, 0.57405268, 0.09328617},
                                                    {0.86446212, 0.57905850, 0.09482352},
                                                    {0.86676901, 0.58408094, 0.09645145},
                                                    {0.86905411, 0.58911967, 0.09816879},
                                                    {0.87131737, 0.59417472, 0.09997355},
                                                    {0.87355889, 0.59924605, 0.10186383},
                                                    {0.87577894, 0.60433346, 0.10383795},
                                                    {0.87797777, 0.60943682, 0.10589408},
                                                    {0.88015531, 0.61455616, 0.10803004},
                                                    {0.88231174, 0.61969139, 0.11024385},
                                                    {0.88444721, 0.62484242, 0.11253354},
                                                    {0.88656198, 0.63000910, 0.11489725},
                                                    {0.88865616, 0.63519140, 0.11733295},
                                                    {0.89072981, 0.64038930, 0.11983860},
                                                    {0.89278305, 0.64560273, 0.12241226},
                                                    {0.89481603, 0.65083165, 0.12505206},
                                                    {0.89682888, 0.65607599, 0.12775614},
                                                    {0.89882174, 0.66133572, 0.13052269},
                                                    {0.90079473, 0.66661079, 0.13334997},
                                                    {0.90274797, 0.67190115, 0.13623626},
                                                    {0.90468160, 0.67720678, 0.13917993},
                                                    {0.90659573, 0.68252766, 0.14217936},
                                                    {0.90849047, 0.68786374, 0.14523303},
                                                    {0.91036594, 0.69321503, 0.14833946},
                                                    {0.91222224, 0.69858150, 0.15149722},
                                                    {0.91405947, 0.70396314, 0.15470495},
                                                    {0.91587775, 0.70935994, 0.15796133},
                                                    {0.91767716, 0.71477191, 0.16126513},
                                                    {0.91945779, 0.72019905, 0.16461513},
                                                    {0.92121989, 0.72564129, 0.16801025},
                                                    {0.92296355, 0.73109863, 0.17144936},
                                                    {0.92468872, 0.73657116, 0.17493140},
                                                    {0.92639549, 0.74205889, 0.17845535},
                                                    {0.92808393, 0.74756185, 0.18202028},
                                                    {0.92975424, 0.75308000, 0.18562529},
                                                    {0.93140669, 0.75861327, 0.18926956},
                                                    {0.93304103, 0.76416185, 0.19295219},
                                                    {0.93465733, 0.76972578, 0.19667241},
                                                    {0.93625590, 0.77530497, 0.20042949},
                                                    {0.93783688, 0.78089942, 0.20422272},
                                                    {0.93939998, 0.78650935, 0.20805139},
                                                    {0.94094543, 0.79213474, 0.21191486},
                                                    {0.94247364, 0.79777544, 0.21581253},
                                                    {0.94398413, 0.80343178, 0.21974379},
                                                    {0.94547723, 0.80910368, 0.22370807},
                                                    {0.94695317, 0.81479110, 0.22770486},
                                                    {0.94841148, 0.82049435, 0.23173362},
                                                    {0.94985293, 0.82621317, 0.23579388},
                                                    {0.95127696, 0.83194788, 0.23988517},
                                                    {0.95268386, 0.83769845, 0.24400704},
                                                    {0.95407377, 0.84346490, 0.24815906},
                                                    {0.95544635, 0.84924747, 0.25234084},
                                                    {0.95680225, 0.85504596, 0.25655197},
                                                    {0.95814072, 0.86086080, 0.26079212},
                                                    {0.95946267, 0.86669168, 0.26506089},
                                                    {0.96076719, 0.87253909, 0.26935799}};

std::array<std::array<float, 3>, 510> const phase{
  std::array<float, 3>{0.34562389, 0.02586483, 0.44469337},
  {0.34662364, 0.02856456, 0.45048271},
  {0.34758271, 0.03140511, 0.45625461},
  {0.34850028, 0.03439273, 0.46200741},
  {0.34937554, 0.03753382, 0.46773936},
  {0.35020766, 0.04082743, 0.47344871},
  {0.35099580, 0.04413799, 0.47913364},
  {0.35173911, 0.04745548, 0.48479230},
  {0.35243671, 0.05078320, 0.49042278},
  {0.35308773, 0.05412401, 0.49602315},
  {0.35369129, 0.05748042, 0.50159143},
  {0.35424649, 0.06085465, 0.50712559},
  {0.35475242, 0.06424862, 0.51262358},
  {0.35520816, 0.06766402, 0.51808337},
  {0.35561279, 0.07110236, 0.52350282},
  {0.35596543, 0.07456492, 0.52887974},
  {0.35626513, 0.07805281, 0.53421195},
  {0.35651100, 0.08156699, 0.53949724},
  {0.35670211, 0.08510828, 0.54473337},
  {0.35683754, 0.08867734, 0.54991812},
  {0.35691632, 0.09227474, 0.55504934},
  {0.35693762, 0.09590090, 0.56012461},
  {0.35690054, 0.09955611, 0.56514165},
  {0.35680420, 0.10324058, 0.57009818},
  {0.35664765, 0.10695446, 0.57499204},
  {0.35643011, 0.11069770, 0.57982082},
  {0.35615075, 0.11447023, 0.58458223},
  {0.35580871, 0.11827187, 0.58927410},
  {0.35540320, 0.12210237, 0.59389418},
  {0.35493350, 0.12596134, 0.59844017},
  {0.35439881, 0.12984838, 0.60290997},
  {0.35379843, 0.13376297, 0.60730143},
  {0.35313176, 0.13770450, 0.61161236},
  {0.35239803, 0.14167236, 0.61584083},
  {0.35159675, 0.14566578, 0.61998473},
  {0.35072731, 0.14968397, 0.62404215},
  {0.34978919, 0.15372608, 0.62801123},
  {0.34878197, 0.15779116, 0.63189011},
  {0.34770513, 0.16187828, 0.63567713},
  {0.34655843, 0.16598633, 0.63937056},
  {0.34534141, 0.17011430, 0.64296892},
  {0.34405395, 0.17426098, 0.64647067},
  {0.34269571, 0.17842524, 0.64987450},
  {0.34126665, 0.18260580, 0.65317909},
  {0.33976661, 0.18680144, 0.65638334},
  {0.33819563, 0.19101083, 0.65948616},
  {0.33655366, 0.19523267, 0.66248666},
  {0.33484091, 0.19946555, 0.66538399},
  {0.33305743, 0.20370816, 0.66817752},
  {0.33120355, 0.20795903, 0.67086665},
  {0.32927949, 0.21221680, 0.67345097},
  {0.32728566, 0.21648000, 0.67593018},
  {0.32522246, 0.22074723, 0.67830410},
  {0.32309038, 0.22501704, 0.68057270},
  {0.32088997, 0.22928800, 0.68273607},
  {0.31862184, 0.23355869, 0.68479443},
  {0.31628667, 0.23782768, 0.68674815},
  {0.31388519, 0.24209358, 0.68859770},
  {0.31141817, 0.24635499, 0.69034370},
  {0.30888649, 0.25061056, 0.69198686},
  {0.30629101, 0.25485894, 0.69352806},
  {0.30363270, 0.25909881, 0.69496825},
  {0.30091255, 0.26332890, 0.69630853},
  {0.29813158, 0.26754796, 0.69755008},
  {0.29529091, 0.27175477, 0.69869420},
  {0.29239161, 0.27594817, 0.69974228},
  {0.28943490, 0.28012700, 0.70069583},
  {0.28642189, 0.28429021, 0.70155640},
  {0.28335390, 0.28843672, 0.70232567},
  {0.28023206, 0.29256557, 0.70300535},
  {0.27705778, 0.29667575, 0.70359729},
  {0.27383219, 0.30076644, 0.70410330},
  {0.27055678, 0.30483670, 0.70452538},
  {0.26723268, 0.30888581, 0.70486543},
  {0.26386142, 0.31291294, 0.70512556},
  {0.26044415, 0.31691746, 0.70530775},
  {0.25698240, 0.32089866, 0.70541417},
  {0.25347737, 0.32485600, 0.70544689},
  {0.24993053, 0.32878887, 0.70540809},
  {0.24634316, 0.33269682, 0.70529992},
  {0.24271660, 0.33657937, 0.70512453},
  {0.23905230, 0.34043611, 0.70488415},
  {0.23535140, 0.34426673, 0.70458088},
  {0.23161548, 0.34807083, 0.70421699},
  {0.22784566, 0.35184822, 0.70379456},
  {0.22404325, 0.35559866, 0.70331575},
  {0.22020973, 0.35932193, 0.70278277},
  {0.21634615, 0.36301793, 0.70219762},
  {0.21245388, 0.36668655, 0.70156243},
  {0.20853426, 0.37032768, 0.70087932},
  {0.20458837, 0.37394135, 0.70015021},
  {0.20061743, 0.37752755, 0.69937712},
  {0.19662292, 0.38108625, 0.69856211},
  {0.19260579, 0.38461758, 0.69770698},
  {0.18856723, 0.38812164, 0.69681362},
  {0.18450850, 0.39159853, 0.69588389},
  {0.18043091, 0.39504837, 0.69491965},
  {0.17633546, 0.39847138, 0.69392254},
  {0.17222333, 0.40186775, 0.69289429},
  {0.16809572, 0.40523768, 0.69183654},
  {0.16395391, 0.40858141, 0.69075094},
  {0.15979912, 0.41189918, 0.68963907},
  {0.15563249, 0.41519128, 0.68850238},
  {0.15145525, 0.41845800, 0.68734232},
  {0.14726872, 0.42169965, 0.68616032},
  {0.14307423, 0.42491653, 0.68495774},
  {0.13887316, 0.42810897, 0.68373588},
  {0.13466699, 0.43127732, 0.68249600},
  {0.13045731, 0.43442189, 0.68123936},
  {0.12624573, 0.43754307, 0.67996710},
  {0.12203396, 0.44064121, 0.67868030},
  {0.11782391, 0.44371669, 0.67738005},
  {0.11361764, 0.44676988, 0.67606736},
  {0.10941742, 0.44980117, 0.67474319},
  {0.10522574, 0.45281094, 0.67340848},
  {0.10104539, 0.45579957, 0.67206410},
  {0.09687947, 0.45876745, 0.67071090},
  {0.09273145, 0.46171499, 0.66934964},
  {0.08860527, 0.46464257, 0.66798109},
  {0.08450540, 0.46755058, 0.66660594},
  {0.08043693, 0.47043942, 0.66522486},
  {0.07640567, 0.47330949, 0.66383845},
  {0.07241840, 0.47616115, 0.66244736},
  {0.06848267, 0.47899481, 0.66105206},
  {0.06460729, 0.48181086, 0.65965307},
  {0.06080242, 0.48460968, 0.65825084},
  {0.05707972, 0.48739166, 0.65684580},
  {0.05345261, 0.49015717, 0.65543833},
  {0.04993647, 0.49290658, 0.65402878},
  {0.04654883, 0.49564027, 0.65261747},
  {0.04330975, 0.49835858, 0.65120475},
  {0.04023822, 0.50106188, 0.64979083},
  {0.03738642, 0.50375053, 0.64837590},
  {0.03486310, 0.50642489, 0.64696015},
  {0.03266695, 0.50908528, 0.64554373},
  {0.03079677, 0.51173204, 0.64412679},
  {0.02925145, 0.51436550, 0.64270949},
  {0.02802961, 0.51698598, 0.64129180},
  {0.02713016, 0.51959381, 0.63987377},
  {0.02655212, 0.52218930, 0.63845541},
  {0.02629480, 0.52477272, 0.63703680},
  {0.02635722, 0.52734438, 0.63561782},
  {0.02673867, 0.52990459, 0.63419839},
  {0.02743862, 0.53245360, 0.63277842},
  {0.02845690, 0.53499168, 0.63135792},
  {0.02979303, 0.53751910, 0.62993663},
  {0.03144695, 0.54003613, 0.62851439},
  {0.03341884, 0.54254298, 0.62709109},
  {0.03570902, 0.54503991, 0.62566653},
  {0.03831785, 0.54752713, 0.62424043},
  {0.04122823, 0.55000488, 0.62281256},
  {0.04431654, 0.55247335, 0.62138277},
  {0.04756227, 0.55493275, 0.61995065},
  {0.05094498, 0.55738326, 0.61851595},
  {0.05444681, 0.55982506, 0.61707845},
  {0.05805198, 0.56225834, 0.61563771},
  {0.06174701, 0.56468324, 0.61419343},
  {0.06552035, 0.56709991, 0.61274532},
  {0.06936200, 0.56950851, 0.61129292},
  {0.07326356, 0.57190915, 0.60983590},
  {0.07721790, 0.57430196, 0.60837391},
  {0.08121897, 0.57668705, 0.60690646},
  {0.08526173, 0.57906451, 0.60543322},
  {0.08934194, 0.58143444, 0.60395375},
  {0.09345609, 0.58379692, 0.60246758},
  {0.09760129, 0.58615201, 0.60097437},
  {0.10177516, 0.58849977, 0.59947359},
  {0.10597578, 0.59084024, 0.59796484},
  {0.11020163, 0.59317346, 0.59644767},
  {0.11445153, 0.59549946, 0.59492157},
  {0.11872457, 0.59781824, 0.59338619},
  {0.12302012, 0.60012981, 0.59184097},
  {0.12733773, 0.60243416, 0.59028550},
  {0.13167716, 0.60473128, 0.58871932},
  {0.13603834, 0.60702112, 0.58714194},
  {0.14042129, 0.60930366, 0.58555296},
  {0.14482622, 0.61157883, 0.58395187},
  {0.14925338, 0.61384658, 0.58233827},
  {0.15370314, 0.61610682, 0.58071168},
  {0.15817595, 0.61835948, 0.57907167},
  {0.16267228, 0.62060446, 0.57741784},
  {0.16719270, 0.62284166, 0.57574972},
  {0.17173780, 0.62507094, 0.57406696},
  {0.17630822, 0.62729220, 0.57236910},
  {0.18090461, 0.62950529, 0.57065580},
  {0.18552766, 0.63171007, 0.56892666},
  {0.19017806, 0.63390638, 0.56718131},
  {0.19485653, 0.63609404, 0.56541944},
  {0.19956378, 0.63827289, 0.56364067},
  {0.20430052, 0.64044274, 0.56184475},
  {0.20906749, 0.64260339, 0.56003132},
  {0.21386536, 0.64475464, 0.55820017},
  {0.21869487, 0.64689628, 0.55635100},
  {0.22355669, 0.64902809, 0.55448361},
  {0.22845149, 0.65114983, 0.55259777},
  {0.23337994, 0.65326127, 0.55069331},
  {0.23834266, 0.65536217, 0.54877007},
  {0.24334027, 0.65745228, 0.54682791},
  {0.24837334, 0.65953133, 0.54486675},
  {0.25344245, 0.66159907, 0.54288649},
  {0.25854812, 0.66365522, 0.54088710},
  {0.26369087, 0.66569951, 0.53886855},
  {0.26887114, 0.66773165, 0.53683086},
  {0.27408939, 0.66975137, 0.53477409},
  {0.27934601, 0.67175837, 0.53269831},
  {0.28464137, 0.67375236, 0.53060364},
  {0.28997579, 0.67573304, 0.52849022},
  {0.29534956, 0.67770012, 0.52635826},
  {0.30076295, 0.67965329, 0.52420796},
  {0.30621614, 0.68159225, 0.52203961},
  {0.31170934, 0.68351669, 0.51985346},
  {0.31724262, 0.68542632, 0.51764991},
  {0.32281614, 0.68732083, 0.51542927},
  {0.32842988, 0.68919991, 0.51319202},
  {0.33408390, 0.69106326, 0.51093856},
  {0.33977811, 0.69291058, 0.50866944},
  {0.34551247, 0.69474158, 0.50638514},
  {0.35128681, 0.69655596, 0.50408629},
  {0.35710101, 0.69835342, 0.50177347},
  {0.36295482, 0.70013369, 0.49944737},
  {0.36884802, 0.70189649, 0.49710866},
  {0.37478028, 0.70364153, 0.49475812},
  {0.38075129, 0.70536854, 0.49239650},
  {0.38676065, 0.70707728, 0.49002464},
  {0.39280796, 0.70876747, 0.48764340},
  {0.39889274, 0.71043889, 0.48525368},
  {0.40501452, 0.71209128, 0.48285641},
  {0.41117273, 0.71372442, 0.48045261},
  {0.41736684, 0.71533810, 0.47804322},
  {0.42359617, 0.71693210, 0.47562940},
  {0.42986019, 0.71850623, 0.47321210},
  {0.43615806, 0.72006032, 0.47079260},
  {0.44248928, 0.72159416, 0.46837186},
  {0.44885284, 0.72310763, 0.46595132},
  {0.45524826, 0.72460055, 0.46353192},
  {0.46167448, 0.72607283, 0.46111514},
  {0.46813089, 0.72752430, 0.45870207},
  {0.47461652, 0.72895487, 0.45629409},
  {0.48113050, 0.73036447, 0.45389255},
  {0.48767212, 0.73175297, 0.45149859},
  {0.49424010, 0.73312038, 0.44911393},
  {0.50083391, 0.73446657, 0.44673958},
  {0.50745241, 0.73579156, 0.44437710},
  {0.51409461, 0.73709532, 0.44202794},
  {0.52075980, 0.73837781, 0.43969328},
  {0.52744667, 0.73963908, 0.43737484},
  {0.53415445, 0.74087914, 0.43507389},
  {0.54088229, 0.74209798, 0.43279172},
  {0.54762890, 0.74329573, 0.43053004},
  {0.55439343, 0.74447241, 0.42829017},
  {0.56117510, 0.74562806, 0.42607338},
  {0.56797283, 0.74676279, 0.42388118},
  {0.57478535, 0.74787678, 0.42171525},
  {0.58161210, 0.74897003, 0.41957666},
  {0.58845213, 0.75004269, 0.41746681},
  {0.59530450, 0.75109488, 0.41538710},
  {0.59745363, 0.74791864, 0.40849571},
  {0.59964866, 0.74471595, 0.40163675},
  {0.60188578, 0.74148732, 0.39481127},
  {0.60416126, 0.73823330, 0.38802027},
  {0.60647145, 0.73495441, 0.38126463},
  {0.60881281, 0.73165121, 0.37454521},
  {0.61118191, 0.72832424, 0.36786276},
  {0.61357542, 0.72497405, 0.36121798},
  {0.61599012, 0.72160118, 0.35461152},
  {0.61842291, 0.71820619, 0.34804393},
  {0.62087079, 0.71478963, 0.34151573},
  {0.62333090, 0.71135203, 0.33502737},
  {0.62580046, 0.70789393, 0.32857923},
  {0.62827684, 0.70441587, 0.32217167},
  {0.63075749, 0.70091839, 0.31580495},
  {0.63324000, 0.69740199, 0.30947932},
  {0.63572205, 0.69386720, 0.30319497},
  {0.63820142, 0.69031453, 0.29695204},
  {0.64067602, 0.68674448, 0.29075063},
  {0.64314383, 0.68315754, 0.28459080},
  {0.64560297, 0.67955420, 0.27847256},
  {0.64805161, 0.67593493, 0.27239590},
  {0.65048803, 0.67230022, 0.26636077},
  {0.65291062, 0.66865051, 0.26036708},
  {0.65531781, 0.66498626, 0.25441472},
  {0.65770815, 0.66130791, 0.24850353},
  {0.66008025, 0.65761591, 0.24263335},
  {0.66243280, 0.65391067, 0.23680397},
  {0.66476456, 0.65019262, 0.23101517},
  {0.66707436, 0.64646217, 0.22526669},
  {0.66936110, 0.64271973, 0.21955827},
  {0.67162373, 0.63896568, 0.21388960},
  {0.67386127, 0.63520042, 0.20826038},
  {0.67607279, 0.63142432, 0.20267027},
  {0.67825741, 0.62763776, 0.19711891},
  {0.68041433, 0.62384112, 0.19160594},
  {0.68254276, 0.62003473, 0.18613098},
  {0.68464198, 0.61621896, 0.18069361},
  {0.68671129, 0.61239416, 0.17529344},
  {0.68875007, 0.60856066, 0.16993003},
  {0.69075769, 0.60471880, 0.16460294},
  {0.69273361, 0.60086891, 0.15931173},
  {0.69467728, 0.59701130, 0.15405595},
  {0.69658820, 0.59314631, 0.14883512},
  {0.69846591, 0.58927423, 0.14364878},
  {0.70030998, 0.58539537, 0.13849646},
  {0.70211999, 0.58151004, 0.13337769},
  {0.70389556, 0.57761854, 0.12829199},
  {0.70563633, 0.57372115, 0.12323892},
  {0.70734196, 0.56981817, 0.11821801},
  {0.70901214, 0.56590989, 0.11322884},
  {0.71064658, 0.56199659, 0.10827100},
  {0.71224501, 0.55807854, 0.10334411},
  {0.71380717, 0.55415603, 0.09844782},
  {0.71533282, 0.55022931, 0.09358186},
  {0.71682174, 0.54629868, 0.08874602},
  {0.71827373, 0.54236438, 0.08394014},
  {0.71968859, 0.53842669, 0.07916423},
  {0.72106615, 0.53448588, 0.07441838},
  {0.72240623, 0.53054219, 0.06970290},
  {0.72370869, 0.52659590, 0.06501828},
  {0.72497338, 0.52264725, 0.06036533},
  {0.72620016, 0.51869652, 0.05574518},
  {0.72738891, 0.51474395, 0.05115942},
  {0.72853952, 0.51078980, 0.04661021},
  {0.72965185, 0.50683433, 0.04210044},
  {0.73072583, 0.50287779, 0.03764481},
  {0.73176134, 0.49892044, 0.03347865},
  {0.73275830, 0.49496254, 0.02964124},
  {0.73371662, 0.49100435, 0.02612362},
  {0.73463622, 0.48704613, 0.02291712},
  {0.73551701, 0.48308813, 0.02001339},
  {0.73635891, 0.47913063, 0.01740441},
  {0.73716187, 0.47517389, 0.01508244},
  {0.73792579, 0.47121818, 0.01304004},
  {0.73865061, 0.46726377, 0.01127011},
  {0.73933627, 0.46331094, 0.00976579},
  {0.73998269, 0.45935997, 0.00852056},
  {0.74058980, 0.45541115, 0.00752817},
  {0.74115754, 0.45146475, 0.00678264},
  {0.74168586, 0.44752106, 0.00627833},
  {0.74217467, 0.44358041, 0.00600982},
  {0.74262389, 0.43964309, 0.00597198},
  {0.74303344, 0.43570943, 0.00615997},
  {0.74340324, 0.43177974, 0.00656919},
  {0.74373322, 0.42785436, 0.00719535},
  {0.74402330, 0.42393363, 0.00803440},
  {0.74427344, 0.42001784, 0.00908263},
  {0.74448350, 0.41610741, 0.01033645},
  {0.74465338, 0.41220270, 0.01179258},
  {0.74478298, 0.40830408, 0.01344801},
  {0.74487224, 0.40441194, 0.01530000},
  {0.74492107, 0.40052664, 0.01734612},
  {0.74492931, 0.39664864, 0.01958398},
  {0.74489686, 0.39277837, 0.02201155},
  {0.74482361, 0.38891625, 0.02462706},
  {0.74470949, 0.38506269, 0.02742907},
  {0.74455431, 0.38121823, 0.03041608},
  {0.74435794, 0.37738333, 0.03358699},
  {0.74412032, 0.37355844, 0.03694108},
  {0.74384125, 0.36974411, 0.04047707},
  {0.74352060, 0.36594089, 0.04403810},
  {0.74315827, 0.36214926, 0.04759008},
  {0.74275408, 0.35836983, 0.05113184},
  {0.74230786, 0.35460319, 0.05466264},
  {0.74181955, 0.35084987, 0.05818238},
  {0.74128892, 0.34711054, 0.06169080},
  {0.74071585, 0.34338581, 0.06518807},
  {0.74010021, 0.33967630, 0.06867458},
  {0.73944179, 0.33598274, 0.07215054},
  {0.73874053, 0.33230572, 0.07561664},
  {0.73799622, 0.32864601, 0.07907326},
  {0.73720874, 0.32500428, 0.08252106},
  {0.73637795, 0.32138127, 0.08596065},
  {0.73550371, 0.31777773, 0.08939260},
  {0.73458592, 0.31419439, 0.09281763},
  {0.73362442, 0.31063206, 0.09623623},
  {0.73261915, 0.30709147, 0.09964914},
  {0.73156995, 0.30357347, 0.10305681},
  {0.73047677, 0.30007880, 0.10645992},
  {0.72933951, 0.29660833, 0.10985888},
  {0.72815812, 0.29316282, 0.11325429},
  {0.72693252, 0.28974314, 0.11664650},
  {0.72566270, 0.28635007, 0.12003601},
  {0.72434861, 0.28298446, 0.12342311},
  {0.72299027, 0.27964713, 0.12680819},
  {0.72158768, 0.27633890, 0.13019147},
  {0.72014088, 0.27306058, 0.13357321},
  {0.71864991, 0.26981298, 0.13695358},
  {0.71711487, 0.26659690, 0.14033271},
  {0.71553584, 0.26341311, 0.14371068},
  {0.71391294, 0.26026239, 0.14708751},
  {0.71224633, 0.25714548, 0.15046319},
  {0.71053618, 0.25406311, 0.15383765},
  {0.70878268, 0.25101599, 0.15721074},
  {0.70698605, 0.24800478, 0.16058236},
  {0.70514655, 0.24503015, 0.16395220},
  {0.70326444, 0.24209269, 0.16732011},
  {0.70134003, 0.23919303, 0.17068565},
  {0.69937366, 0.23633166, 0.17404863},
  {0.69736567, 0.23350914, 0.17740850},
  {0.69531644, 0.23072589, 0.18076502},
  {0.69322638, 0.22798239, 0.18411751},
  {0.69109593, 0.22527896, 0.18746570},
  {0.68892554, 0.22261599, 0.19080884},
  {0.68671569, 0.21999373, 0.19414658},
  {0.68446688, 0.21741245, 0.19747816},
  {0.68217965, 0.21487231, 0.20080310},
  {0.67985454, 0.21237346, 0.20412072},
  {0.67749211, 0.20991599, 0.20743034},
  {0.67509296, 0.20749993, 0.21073145},
  {0.67265770, 0.20512528, 0.21402307},
  {0.67018694, 0.20279196, 0.21730480},
  {0.66768132, 0.20049984, 0.22057586},
  {0.66514150, 0.19824876, 0.22383540},
  {0.66256814, 0.19603850, 0.22708294},
  {0.65996192, 0.19386878, 0.23031767},
  {0.65732353, 0.19173929, 0.23353874},
  {0.65465367, 0.18964964, 0.23674566},
  {0.65195303, 0.18759942, 0.23993771},
  {0.64922235, 0.18558818, 0.24311402},
  {0.64646234, 0.18361540, 0.24627398},
  {0.64367372, 0.18168054, 0.24941698},
  {0.64085720, 0.17978299, 0.25254236},
  {0.63801353, 0.17792214, 0.25564946},
  {0.63514345, 0.17609730, 0.25873749},
  {0.63224769, 0.17430779, 0.26180591},
  {0.62932696, 0.17255286, 0.26485416},
  {0.62638200, 0.17083174, 0.26788164},
  {0.62341354, 0.16914363, 0.27088778},
  {0.62042231, 0.16748770, 0.27387203},
  {0.61740902, 0.16586310, 0.27683384},
  {0.61437439, 0.16426895, 0.27977271},
  {0.61131915, 0.16270436, 0.28268815},
  {0.60824398, 0.16116839, 0.28557968},
  {0.60514960, 0.15966012, 0.28844688},
  {0.60203670, 0.15817857, 0.29128932},
  {0.59890597, 0.15672279, 0.29410661},
  {0.59575808, 0.15529179, 0.29689838},
  {0.59259371, 0.15388457, 0.29966431},
  {0.58941352, 0.15250012, 0.30240407},
  {0.58621817, 0.15113744, 0.30511737},
  {0.58300835, 0.14979546, 0.30780373},
  {0.57978466, 0.14847318, 0.31046311},
  {0.57654773, 0.14716958, 0.31309531},
  {0.57329818, 0.14588361, 0.31570015},
  {0.57003662, 0.14461423, 0.31827746},
  {0.56676373, 0.14336034, 0.32082677},
  {0.56348002, 0.14212096, 0.32334832},
  {0.56018609, 0.14089503, 0.32584204},
  {0.55688255, 0.13968148, 0.32830766},
  {0.55356999, 0.13847925, 0.33074513},
  {0.55024889, 0.13728734, 0.33315468},
  {0.54691986, 0.13610466, 0.33553610},
  {0.54358346, 0.13493016, 0.33788942},
  {0.54024014, 0.13376286, 0.34021499},
  {0.53689055, 0.13260160, 0.34251240},
  {0.53353508, 0.13144544, 0.34478225},
  {0.53017432, 0.13029329, 0.34702441},
  {0.52680874, 0.12914411, 0.34923912},
  {0.52343880, 0.12799687, 0.35142664},
  {0.52006505, 0.12685049, 0.35358704},
  {0.51668788, 0.12570398, 0.35572074},
  {0.51330782, 0.12455623, 0.35782784},
  {0.50992528, 0.12340624, 0.35990879},
  {0.50654072, 0.12225292, 0.36196384},
  {0.50315461, 0.12109521, 0.36399329},
  {0.49976729, 0.11993208, 0.36599774},
  {0.49637931, 0.11876236, 0.36797719},
  {0.49299095, 0.11758507, 0.36993252},
  {0.48960272, 0.11639903, 0.37186385},
  {0.48621497, 0.11520316, 0.37377178},
  {0.48282803, 0.11399635, 0.37565700},
  {0.47944243, 0.11277736, 0.37751962},
  {0.47605842, 0.11154509, 0.37936053},
  {0.47267636, 0.11029836, 0.38118036},
  {0.46929671, 0.10903587, 0.38297941},
  {0.46591975, 0.10775639, 0.38475851},
  {0.46254581, 0.10645866, 0.38651839},
  {0.45917524, 0.10514132, 0.38825969},
  {0.45580845, 0.10380293, 0.38998289},
  {0.45244567, 0.10244212, 0.39168900},
  {0.44908722, 0.10105740, 0.39337875},
  {0.44573342, 0.09964720, 0.39505294},
  {0.44238465, 0.09820983, 0.39671216},
  {0.43904114, 0.09674364, 0.39835742},
  {0.43570319, 0.09524681, 0.39998961},
  {0.43237108, 0.09371743, 0.40160962},
  {0.42904511, 0.09215348, 0.40321835},
  {0.42572557, 0.09055279, 0.40481668},
  {0.42241277, 0.08891303, 0.40640552},
  {0.41910693, 0.08723176, 0.40798597},
  {0.41580833, 0.08550631, 0.40955904},
  {0.41251723, 0.08373380, 0.41112576},
  {0.40923392, 0.08191112, 0.41268721},
  {0.40595864, 0.08003485, 0.41424446},
  {0.40269167, 0.07810126, 0.41579865},
  {0.39943327, 0.07610625, 0.41735090},
  {0.39618370, 0.07404528, 0.41890239},
  {0.39294325, 0.07191330, 0.42045428},
  {0.38971217, 0.06970469, 0.42200783},
  {0.38649072, 0.06741312, 0.42356430},
  {0.38327919, 0.06503140, 0.42512500},
  {0.38007785, 0.06255137, 0.42669122},
  {0.37688698, 0.05996364, 0.42826431},
  {0.37370687, 0.05725733, 0.42984566},
  {0.37053784, 0.05441971, 0.43143666},
  {0.36738018, 0.05143574, 0.43303877},
  {0.36423422, 0.04828739, 0.43465347},
  {0.36110029, 0.04495279, 0.43628226},
  {0.35797874, 0.04140492, 0.43792669},
  {0.35486994, 0.03762124, 0.43958837},
  {0.35177425, 0.03375967, 0.44126892},
  {0.34869210, 0.02984150, 0.44297001},
};

auto ColorizeComplex(Cx2 const &img, float const max, float const ) -> RGBImage
{
  auto const nX = img.dimension(0);
  auto const nY = img.dimension(1);
  auto       rgb = RGBImage(3, nX, nY);
  rgb.setZero();
  for (int iy = 0; iy < nY; iy++) {
    for (int ix = 0; ix < nX; ix++) {
      float const abs = std::abs(img(ix, iy));
      float const scale = std::pow(abs / max, );
      float const pha = std::arg(img(ix, iy));
      Index const index = ((pha + M_PI) / (2.f * M_PI)) * (phase.size() - 1);

      std::array<float, 3> const &color = phase[index];
      rgb(0, ix, iy) = (uint8_t)std::clamp(color[0] * scale * 255.f, 0.f, 255.f);
      rgb(1, ix, iy) = (uint8_t)std::clamp(color[1] * scale * 255.f, 0.f, 255.f);
      rgb(2, ix, iy) = (uint8_t)std::clamp(color[2] * scale * 255.f, 0.f, 255.f);
    }
  }
  return rgb;
}

auto ColorizeReal(Re2 const &img, float const min, float const max, float const ) -> RGBImage
{
  auto const nX = img.dimension(0);
  auto const nY = img.dimension(1);
  auto       rgb = RGBImage(3, nX, nY);
  rgb.setZero();
  for (int iy = 0; iy < nY; iy++) {
    for (int ix = 0; ix < nX; ix++) {
      float const val = std::clamp(std::pow((img(ix, iy) - min) / (max - min), ), 0.f, 1.f);
      Index const index = val * (iceburn.size() - 1);

      std::array<float, 3> const &color = iceburn[index];
      rgb(0, ix, iy) = (uint8_t)std::clamp(color[0] * 255.f, 0.f, 255.f);
      rgb(1, ix, iy) = (uint8_t)std::clamp(color[1] * 255.f, 0.f, 255.f);
      rgb(2, ix, iy) = (uint8_t)std::clamp(color[2] * 255.f, 0.f, 255.f);
    }
  }
  return rgb;
}

auto Greyscale(Re2 const &img, float const min, float const max, float const ) -> RGBImage
{
  auto const nX = img.dimension(0);
  auto const nY = img.dimension(1);
  auto       rgb = RGBImage(3, nX, nY);
  rgb.setZero();
  for (int iy = 0; iy < nY; iy++) {
    for (int ix = 0; ix < nX; ix++) {
      float const val = std::clamp(std::pow((img(ix, iy) - min) / (max - min), ), 0.f, 1.f);

      rgb(0, ix, iy) = (uint8_t)std::clamp(white[0] * val * 255.f, 0.f, 255.f);
      rgb(1, ix, iy) = (uint8_t)std::clamp(white[1] * val * 255.f, 0.f, 255.f);
      rgb(2, ix, iy) = (uint8_t)std::clamp(white[2] * val * 255.f, 0.f, 255.f);
    }
  }
  return rgb;
}

} // namespace rl
